---
---

<button
  id="theme-toggle"
  class="theme-toggle nav-bar-enter"
  type="button"
  aria-label="Switch to dark mode"
>
  <!-- Sun icon — shown in dark mode to switch back to light -->
  <svg
    class="icon-sun"
    width="18"
    height="18"
    viewBox="0 0 24 24"
    fill="none"
    aria-hidden="true"
  >
    <circle cx="12" cy="12" r="4" stroke="currentColor" stroke-width="1.5" />
    <path
      d="M12 2v2M12 20v2M2 12h2M20 12h2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M17.66 6.34l-1.41 1.41M6.34 17.66l-1.41 1.41"
      stroke="currentColor"
      stroke-width="1.5"
      stroke-linecap="round"
    ></path>
  </svg>

  <!-- Moon icon — shown in light mode to switch to dark -->
  <svg
    class="icon-moon"
    width="18"
    height="18"
    viewBox="0 0 24 24"
    fill="none"
    aria-hidden="true"
  >
    <path
      d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"
      stroke="currentColor"
      stroke-width="1.5"
      stroke-linecap="round"
      stroke-linejoin="round"
    ></path>
  </svg>
</button>

<style>
  .theme-toggle {
    position: fixed;
    top: var(--nav-bottom-offset);
    right: var(--grid-margin);
    z-index: 100;

    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;

    background: var(--nav-glass-bg);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-full);
    box-shadow: var(--shadow-md);

    color: var(--color-text-secondary);
    cursor: pointer;

    transition:
      background-color var(--duration-fast) var(--ease-out),
      color var(--duration-fast) var(--ease-out),
      border-color var(--duration-normal) var(--ease-out);
  }

  .theme-toggle:hover {
    color: var(--color-text-primary);
    background: var(--nav-glass-hover);
  }

  /* Default: light mode shows moon, dark mode shows sun */
  .icon-sun {
    display: none;
  }
  .icon-moon {
    display: block;
  }

  :global([data-theme="dark"]) .icon-sun {
    display: block;
  }
  :global([data-theme="dark"]) .icon-moon {
    display: none;
  }
</style>

<script>
  const toggle = document.getElementById("theme-toggle");
  const html = document.documentElement;

  function setTheme(theme: string) {
    html.dataset.theme = theme;
    localStorage.setItem("theme", theme);
    if (toggle) {
      toggle.setAttribute(
        "aria-label",
        theme === "dark" ? "Switch to light mode" : "Switch to dark mode",
      );
    }
  }

  // Sync aria-label with the theme already set by the inline init script
  const initialTheme = html.dataset.theme || "light";
  if (toggle) {
    toggle.setAttribute(
      "aria-label",
      initialTheme === "dark" ? "Switch to light mode" : "Switch to dark mode",
    );
  }

  toggle?.addEventListener("click", () => {
    const current = html.dataset.theme || "light";
    setTheme(current === "dark" ? "light" : "dark");
  });
</script>
